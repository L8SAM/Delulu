
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Delulu-List mit Firebase-Kommentaren</title>
  <style>
    :root {
      --bg: #d8b4f8;
      --text: #111;
      --card: #fff;
      --highlight: #8e44ad;
    }
    body.dark {
      --bg: #1e1e1e;
      --text: #eee;
      --card: #2a2a2a;
      --highlight: #9b59b6;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: sans-serif;
      margin: 0;
      padding: 2rem;
      transition: background 0.4s, color 0.4s;
    }
    .container { max-width: 800px; margin: auto; }
    .toggle-theme { float: right; border: 1px solid var(--text); background: none; color: var(--text); padding: 5px 10px; border-radius: 8px; }
    h1 { text-align: center; }
    input, select, button, textarea {
      padding: 10px;
      border-radius: 8px;
      font-size: 1rem;
      border: 1px solid #ccc;
      background: var(--card);
      color: var(--text);
    }
    button { background: var(--highlight); color: white; border: none; cursor: pointer; transition: transform 0.2s ease; }
    button:hover { transform: scale(1.05); }
    .controls, .note-controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 1rem; }
    ul { list-style: none; padding: 0; }
    li {
      background: var(--card); margin-bottom: 10px; padding: 1rem;
      border-radius: 8px; animation: fadeIn 0.4s ease;
    }
    .comment-section { margin-top: 10px; }
    .comment-section input { width: 100%; margin-top: 5px; }
    .suggestion { margin: 1rem 0; font-style: italic; background: var(--card); padding: 10px; border-left: 4px solid var(--highlight); border-radius: 6px; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="toggle-theme" onclick="toggleTheme()">ðŸŒ— Theme</button>
    <h1>Delulu-List Pro</h1>
    <div class="suggestion" id="goalSuggestion">ðŸ’¡ Zielidee: wird geladen...</div>

    <div class="controls">
      <input type="text" id="itemText" placeholder="Traumziel..." />
      <select id="itemAuthor">
        <option value="Noah">Noah</option>
        <option value="Shirin">Shirin</option>
      </select>
      <select id="itemTimeframe">
        <option value="jetzt">Jetzt</option>
        <option value="jahr">Im nÃ¤chsten Jahr</option>
        <option value="zukunft">Irgendwann</option>
      </select>
      <button onclick="addItem()">âž• HinzufÃ¼gen</button>
    </div>

    <ul id="bucketList"></ul>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBKrD4FnVNxhAtcm8vLfNA0xvReYbjQkLY",
      authDomain: "delulu-b5416.firebaseapp.com",
      databaseURL: "https://delulu-b5416-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "delulu-b5416",
      storageBucket: "delulu-b5416.appspot.com",
      messagingSenderId: "758486842158",
      appId: "1:758486842158:web:b423e2ea1e1058f36c18bf",
      measurementId: "G-BFTV5VK69N"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const goalsRef = db.ref("goals");

    const suggestions = [
      "Eine Nacht unter freiem Himmel verbringen",
      "Ein Lied schreiben",
      "BarfuÃŸ im Regen tanzen",
      "Einen HeiÃŸluftballonflug machen",
      "Einen Monat offline leben",
      "Jemandem anonym helfen",
      "In einer Jurte schlafen",
      "Eine neue Sprache ausprobieren",
      "Ein Dankesbrief an sich selbst schreiben"
    ];
    function updateSuggestion() {
      const i = Math.floor(Math.random() * suggestions.length);
      document.getElementById("goalSuggestion").textContent = "ðŸ’¡ Zielidee: " + suggestions[i];
    }
    updateSuggestion();

    function toggleTheme() {
      document.body.classList.toggle("dark");
      localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
    }
    window.addEventListener("DOMContentLoaded", () => {
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark") document.body.classList.add("dark");
    });

    function addItem() {
      const text = document.getElementById("itemText").value.trim();
      const author = document.getElementById("itemAuthor").value;
      const timeframe = document.getElementById("itemTimeframe").value;
      if (!text) return;
      const newGoal = { text, author, timeframe, comments: [] };
      goalsRef.push(newGoal);
      document.getElementById("itemText").value = "";
    }

    function addComment(goalId, text) {
      if (!text.trim()) return;
      const commentRef = db.ref("goals/" + goalId + "/comments");
      commentRef.once("value", snapshot => {
        const comments = snapshot.val() || [];
        comments.push(text);
        commentRef.set(comments);
      });
    }

    function renderGoals() {
      goalsRef.on("value", snapshot => {
        const list = document.getElementById("bucketList");
        list.innerHTML = "";
        snapshot.forEach(child => {
          const goal = child.val();
          const key = child.key;
          const li = document.createElement("li");
          li.innerHTML = `
            <div><strong>${goal.text}</strong> (${goal.author}, ${goal.timeframe})</div>
            <div class="comment-section">
              <input type="text" placeholder="Kommentar hinzufÃ¼gen..." onkeypress="if(event.key==='Enter'){ addComment('${key}', this.value); this.value=''; }" />
              <div>${(goal.comments || []).map(c => "ðŸ’¬ " + c).join("<br>")}</div>
            </div>`;
          list.appendChild(li);
        });
      });
    }
    renderGoals();
  </script>
</body>
</html>
